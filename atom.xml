<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[heXoughts - arco's braindumps & musings]]></title>
  <link href="http://arcolife.github.io/atom.xml" rel="self"/>
  <link href="http://arcolife.github.io/"/>
  <updated>2020-02-07T08:21:20+05:30</updated>
  <id>http://arcolife.github.io/</id>
  <author>
    <name><![CDATA[Archit Sharma]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[GRA FCUK? NAh]]></title>
    <link href="http://arcolife.github.io/blog/2020/02/07/gra-fcuk-nah/"/>
    <updated>2020-02-07T07:47:27+05:30</updated>
    <id>http://arcolife.github.io/blog/2020/02/07/gra-fcuk-nah</id>
    <content type="html"><![CDATA[<p>yearly resentment (this would be the last) over a failed contribution:</p>

<ul>
<li><a href="https://github.com/grafana/grafana/pull/7863#issuecomment-354004166">https://github.com/grafana/grafana/pull/7863#issuecomment-354004166</a></li>
<li><a href="https://github.com/grafana/grafana/issues/4693">https://github.com/grafana/grafana/issues/4693</a></li>
<li><a href="https://community.grafana.com/t/advanced-query-with-nested-object/4278/2">https://community.grafana.com/t/advanced-query-with-nested-object/4278/2</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Recovering Encrypted LVM Based Partitions, After Accidentally Overwriting 'Em With 'Fio'!]]></title>
    <link href="http://arcolife.github.io/blog/2017/04/30/recovering-an-encrypted-partition-after-accidentally-overwriting-it-with-fio/"/>
    <updated>2017-04-30T08:09:01+05:30</updated>
    <id>http://arcolife.github.io/blog/2017/04/30/recovering-an-encrypted-partition-after-accidentally-overwriting-it-with-fio</id>
    <content type="html"><![CDATA[<p>Disclaimer: Logging my experience of a quasi-success in executing <code>$subject</code>.</p>

<h4>Specs</h4>

<ul>
<li>Partitioning scheme: LVM based encrypted partitions</li>
<li>Hardware - Lenovo T440p</li>
<li>OS (earlier) - Fedora 24 Gnome</li>
<li>OS (now) - Fedora 24 KDE</li>
</ul>


<p>As if there aren&rsquo;t enough cases already, this one found a grand entrance to the club of royally screwed ups, when it comes to messing up with your disk partitions.</p>

<!--more-->


<h5>Backstory and the foreplay</h5>

<p>I supplied <a href="https://github.com/arcolife/kvm_io/blob/master/bench_iter.sh#L113">this command</a> but with <code>fio</code> instead of <code>pbench-fio</code>. I thought the options would be similar to what <code>fio</code> supports, so I ran it with<code>--client=&lt;IP of VM&gt;</code> which it obviously didn&rsquo;t support and reacted to, with a complaint. The command I then ran using ssh, was something this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>fio --filename=/dev/sda --direct=1 --rw=randwrite --refill_buffers --ioengine=libaio --bs=128k --rate_iops=1280  --iodepth=16 --numjobs=8 --runtime=20 </span></code></pre></td></tr></table></div></figure>


<p>But I managed to mess it up and this ran on host&rsquo;s <code>/dev/sda</code> instead of VM&rsquo;s. Albeit, I didn&rsquo;t realize the blunder in that moment and later rebooted the machine. Well then obviously it wouldn&rsquo;t boot up and so it went into PXE boot mode. With 0 pendrives within my reach, I PXE booted through my office&rsquo;s network and thought I&rsquo;d use the liveuser to recover. But that went into the <code>#dracut</code> mode. I went back home and finally used a live USB to boot into the laptop. On checking for partitions through <code>fdisk</code>, I couldn&rsquo;t see any. Whelp!</p>

<p>And in the install menu&rsquo;s disk selection option, it didn&rsquo;t show up the partitions either..</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/manual_partition_without.jpeg" alt="Manual Partition - Free" /></p>

<h4>The act of repression</h4>

<p>So then I downloaded testdisk [1] and followed those step-by-step instructions. Unfortunately, mine was a case of an encrypted ext4 partition, which isn&rsquo;t what that testdisk&rsquo;s version supports (for listing files) out of the box. But on a &lsquo;quick search&rsquo;, testdisk did discover 2 partitions (Bootable and Primary) and on a &lsquo;deeper search&rsquo;, other parititions with labels P and D (Primary/Deleted [1]). I chose to write the quick search partition table and the exited the tool.</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/testdisk_quick.jpeg" alt="quick testdisk" />
<img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/testdisk_deeper.jpeg" alt="deep testdisk" />
<img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/partition_post_testdisk.jpeg" alt="Post testdisk" /></p>

<p>Later, I ran another tool <code>PhotoRec</code> [2] by the same author behind <code>testdisk</code> and that helped me recover 4 txt files and 3 LUKS files. I wrote the partitions it found out, to the table. It would only make sense if I could somehow decrypt and mount/scan the .LUKS files. I used an external hard drive and saved them to it while supplying the same as an option to PhotoRec.</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/photorec_deep.jpeg" alt="Photo Rec deep" /></p>

<p>Note that this was a hurdle I <em>had to</em> cross since they&rsquo;re encrypted partitions. Generally speaking, if we&rsquo;ve got N encrypted partitions, but the initial few sectors containing the header volume info for passphrase are overwritten, it&rsquo;s often impossible to recover data (as of what I understood from conversations in forums). But this might be considered as an advantage in cases where you&rsquo;d like to mess up the hard drive on purpose, since erasing the first few bytes does the job, as the data in rest of the sectors is encrypted af.</p>

<p>Getting back to point, I followed [3] and mapped those LUKS files to the VG pool (although unsuccessfully). Error that I spotted (under <code>/var/log/messages</code>) was somewhere along the lines of <code>vgchange buffer io error on device sda &lt;snip snip&gt; logical block: LUKS I/O error -5 writing to inode</code>.</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/luks_dump.jpeg" alt="LUKS dump" />
<img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/luks_open.jpeg" alt="LUKS open" />
<img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/pvs.jpeg" alt="PVS" /></p>

<p>Side note: Neither in PhotoRec nor in TestDisk, did I attempt to re-write MBR table.</p>

<p>On the edge of a Post Traumatic Scan Disorder from Testdisk and photoRec, I almost gave up while recalling suggestions from a few forums, which pointed to the fact that it&rsquo;s impossible to recover encrypted partitions if the header volume info wasn&rsquo;t backed up. It all seemed gloomy and dark and I slept thereafter while putting another photoRec scan to work in the background.</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/vgchange_error.jpeg" alt="Vgchange error" /></p>

<p>A couple hours later, I tried to wake up the laptop screen but it wouldn&rsquo;t (Fedora 24 KDE does that sometimes it seems). Trudging back to the idea of starting over, I hard rebooted and decided to install the OS, from scratch. But to my surprise, while booting up with the live USB and inside the install menu&rsquo;s disk partitioning scheme option <code>I'll configure partition myself</code>, I saw an &ldquo;Unknown&rdquo; partitioning dropdown. Now now, this didn&rsquo;t show up earlier and so then I went ahead and removed all but the biggest one (which I knew was the home partition). I supplied the passphrase for older encryption, specified a mount point <code>/home</code>, made other parititions (all except biosboot [5]) and Voila! all I had to do later was to reinstall some rpm packages.</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/manual_partition_with.jpeg" alt="Manual Partition - Unknown" /></p>

<p>So to speak, I&rsquo;m not sure what gave or how it worked, but it did! Tag-lining this as a &ldquo;comedy of errors and a tragedy to remember&rdquo;.</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/final.jpeg" alt="Happy" /></p>

<p>PS: On recovery, I&rsquo;ve lost some disk space ( ~ 80 MiB) fragmented and squeezed in between those partitions. Also, my RAM shows up as 15.4 GiB instead of 16 GiB. Or maybe that&rsquo;s just how accurate a System Monitor in KDE is?!</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/recovery/fragments.jpeg" alt="Fragments count" /></p>

<h4>References</h4>

<ol>
<li><a href="http://www.cgsecurity.org/wiki/TestDisk_Step_By_Step">http://www.cgsecurity.org/wiki/TestDisk_Step_By_Step</a></li>
<li><a href="http://www.cgsecurity.org/wiki/PhotoRec_Step_By_Step">http://www.cgsecurity.org/wiki/PhotoRec_Step_By_Step</a></li>
<li><a href="https://alvinabad.wordpress.com/2012/09/22/how-to-recover-a-luks-encrypted-disk/">https://alvinabad.wordpress.com/2012/09/22/how-to-recover-a-luks-encrypted-disk/</a></li>
<li><a href="https://forum.cgsecurity.org/phpBB3/viewtopic.php?t=1431">Recovering files from an encrypted drive</a></li>
<li><a href="https://www.redhat.com/archives/kickstart-list/2012-August/msg00005.html">Re: how to tell when biosboot partition is needed?</a></li>
<li><a href="https://forum.cgsecurity.org/phpBB3/viewtopic.php?t=462">USB stick unreadable</a></li>
<li><a href="http://www.pavelkogan.com/2014/05/23/luks-full-disk-encryption/">http://www.pavelkogan.com/2014/05/23/luks-full-disk-encryption/</a></li>
<li><a href="http://manpages.ubuntu.com/manpages/xenial/man1/ecryptfs-recover-private.1.html">http://manpages.ubuntu.com/manpages/xenial/man1/ecryptfs-recover-private.1.html</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Performance Engineering TILs - Part 1]]></title>
    <link href="http://arcolife.github.io/blog/2017/03/02/performance-engineering-tils-part-1/"/>
    <updated>2017-03-02T17:00:16+05:30</updated>
    <id>http://arcolife.github.io/blog/2017/03/02/performance-engineering-tils-part-1</id>
    <content type="html"><![CDATA[<h2>On Scale tests</h2>

<h4>..on distributed systems, in companies with a global, collaborative and distributed workplace setup</h4>

<p>Before running a scale test, make sure to have the following items checked off your list:</p>

<ol>
<li>Is churn on product integrations, enough to simulate production environment?</li>
<li>During the tests, is the product going to run with defaults? Is this about baselining with defaults or are we going to let the system bleed while increasing throughputs?</li>
<li>Do you have exact expectations noted down prior to automating? (per se, monitoring enough parameters in the right way. This includes Telemetry, Logs and Configurations per iteration.)</li>
</ol>


<!--more-->


<p>   An example of this, from a distributed systems application framework could be:</p>

<ul>
<li> Time spent collecting the data as well as size of data v/s Time it took to be committed to the db &ndash; per se, fetch time/volume and db time.</li>
<li><p> Size of data transferred over network for a single workload (and for all workloads/functionalities associated with that application)</p></li>
<li><p>List of parameters not to be changed? CPU/RAM/Memory/Disk/partitions/Network bandwidth/OS/Installed Packages/Tuning parameters/&hellip;.</p></li>
<li>Do you have tuning recommendations for the product, prior to testing?</li>
<li>Do you have enough debugging skills on the product, to begin with? (extension: Have you solved enough bugs yet?). If not, it&rsquo;s good to have some consultation on this as it helps with forming theories on conclusions.</li>
<li>Do you have the lab environment&rsquo;s hardware availability dates in a flexible time range? (keeping potential bottlenecks in mind)</li>
</ul>


<p>I have been reading Brendon Gregg&rsquo;s <a href="http://www.brendangregg.com/sysperfbook.html">&ldquo;Systems Performance: Enterprise and the Cloud&rdquo;</a> and am inclined to finish this soon. All of the points above, have probably been already covered in detail, in that book.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Resizing an Xfs Partition on a Thin Provisoned Disk in a RHVM Env]]></title>
    <link href="http://arcolife.github.io/blog/2017/02/22/resizing-an-xfs-partition-on-a-thin-provisoned-disk-in-a-rhvm-env/"/>
    <updated>2017-02-22T02:53:28+05:30</updated>
    <id>http://arcolife.github.io/blog/2017/02/22/resizing-an-xfs-partition-on-a-thin-provisoned-disk-in-a-rhvm-env</id>
    <content type="html"><![CDATA[<p>My postgres parition was full and I desperately needed to increase its size, in order to report some performance numbers.</p>

<p>I couldn&rsquo;t afford to loose the data (and my shit). So I followed these steps to safely increase the size of that partition based on xfs, which existed on a logical volume already.</p>

<p>Self help commands and assumptions:</p>

<ul>
<li>disk is /dev/vdb/</li>
<li>xfs is mounted on /dev/vg_pg/lv_pg</li>
<li>we grew the disk by 20 Gigs</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>xfs_info /dev/vg_pg/lv_pg -d 64G</span></code></pre></td></tr></table></div></figure>




<!--more-->


<p>Delete and resize partition. Let&rsquo;s say we&rsquo;re working with Partition 1 here:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>fdisk /dev/vdb
</span><span class='line'>
</span><span class='line'># p
</span><span class='line'>(list paritions)
</span><span class='line'>
</span><span class='line'># d
</span><span class='line'>(confirm delete)
</span><span class='line'>
</span><span class='line'># n
</span><span class='line'>(make new parition with default values, after you've extended disk size from RHEVM env)
</span><span class='line'>
</span><span class='line'># w
</span><span class='line'>(save changes)</span></code></pre></td></tr></table></div></figure>


<p>Now, reboot system.</p>

<p>Run <code>partprobe</code> to be sure all went well.</p>

<p>Then, run these set of commands:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>pvresize /dev/vdb1
</span><span class='line'>pvs
</span><span class='line'>lvextend -L +20G /dev/mapper/vg_pg-lv_pg
</span><span class='line'>lvs
</span><span class='line'>xfs_growfs /dev/vg_pg/lv_pg</span></code></pre></td></tr></table></div></figure>


<p>Refs:</p>

<ol>
<li><a href="https://help.1and1.com/servers-c37684/dynamic-cloud-server-linux-c73266/increase-the-physical-volume-size-of-a-linux-1and1-dynamic-cloud-server-a771780.html">https://help.1and1.com/servers-c37684/dynamic-cloud-server-linux-c73266/increase-the-physical-volume-size-of-a-linux-1and1-dynamic-cloud-server-a771780.html</a></li>
<li><a href="https://access.redhat.com/solutions/697303">https://access.redhat.com/solutions/697303</a></li>
<li><a href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/xfsgrow.html">https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Storage_Administration_Guide/xfsgrow.html</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[#noteToSelf - Fix MariaDB-selinux Related Errors (Fails to Restart After Update)]]></title>
    <link href="http://arcolife.github.io/blog/2017/01/19/number-notetoself-fix-mariadb-selinux-related-errors-fails-to-restart-after-update/"/>
    <updated>2017-01-19T21:37:53+05:30</updated>
    <id>http://arcolife.github.io/blog/2017/01/19/number-notetoself-fix-mariadb-selinux-related-errors-fails-to-restart-after-update</id>
    <content type="html"><![CDATA[<p><a href="https://jira.mariadb.org/browse/MDEV-11789">https://jira.mariadb.org/browse/MDEV-11789</a></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>yum -y install MariaDB-devel  gcc gcc-c++ autoconf automake make libtool   zlib zlib-devel openssl-devel
</span><span class='line'>yum install -y MySQL-server
</span><span class='line'> 
</span><span class='line'># tried this, didn't work (where /home/native is the directory with mysql database is stored; configurable in my.cnf)
</span><span class='line'>semanage fcontext -a -t mysqld_db_t "/home/native(/.*)?"
</span><span class='line'>restorecon -Rv /home/native/
</span><span class='line'>yum install selinux-policy
</span><span class='line'>audit2allow -a
</span><span class='line'>yum install yum-utils
</span><span class='line'>yum-complete-transaction
</span><span class='line'> 
</span><span class='line'># then tried this
</span><span class='line'>yum provides sealert
</span><span class='line'>yum install setroubleshoot-server
</span><span class='line'>sealert -a /var/log/audit/audit.log
</span><span class='line'># this produces alerts from audit.log and provides hints as to what should be executed next..
</span><span class='line'> 
</span><span class='line'># so i followed directions..
</span><span class='line'>ausearch -c 'mysqld_safe_hel' --raw | audit2allow -M my-mysqldsafehel
</span><span class='line'>semodule -i my-mysqldsafehel.pp</span></code></pre></td></tr></table></div></figure>




<!--more-->

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Monitoring in Satperf: Metrics Collection]]></title>
    <link href="http://arcolife.github.io/blog/2016/10/05/monitoring-in-satperf-metrics-collection/"/>
    <updated>2016-10-05T18:21:42+05:30</updated>
    <id>http://arcolife.github.io/blog/2016/10/05/monitoring-in-satperf-metrics-collection</id>
    <content type="html"><![CDATA[<p>Satperf utilizes a visualization framework called Grafana, to present graphs.</p>

<h3>Metrics Collected</h3>

<p>An explanation of how the following metrics are placed in the satperf monitoring dashboard, is described in the <a href="#overview">&lsquo;Grafana Dashboard&rsquo;</a> section. If you wanna copy these metrics, refer to <a href="#references">this file [2] in references</a></p>

<!--more-->


<ul>
<li>The panels that <a href="https://www.github.com/redhat-performance/satperf">satperf</a> monitoring module provides:</li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/source/source/images/collectd/process_panels.png" alt="Figure 1" /></p>

<ul>
<li>The metrics that <a href="https://www.github.com/redhat-performance/satperf">satperf</a> monitoring module collects for processes:</li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/source/source/images/collectd/process_metrics.png" alt="Figure 1" /></p>

<h4>Overview<h3 id="overview"></a></h4>

<p>The Grafana dashboard is divided into rows and each row has either a single or multiple panels.
Each of those panels query specific metrics. Here&rsquo;s how those metrics in the template <a href="#references">[1]</a> are grouped:</p>

<ul>
<li>Grafana variable templating</li>
<li>Rows > Panels > Queries</li>
</ul>


<p>The rows are named as following:</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/source/source/images/grafana/rows.png" alt="Figure 1" /></p>

<p>A sample &ldquo;CPU ALL&rdquo; row with all panels:</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/source/source/images/grafana/rows_panels.png" alt="Figure 2" /></p>

<p>On clicking edit in one of the panels in that row, we get the metric query frame, like this:</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/source/source/images/grafana/panel_edit.png" alt="Figure 3" /></p>

<p>The templating <code>$Cloud</code>, <code>$Node</code> etc.. are included at the top of the dashboard, like this:</p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/source/source/images/grafana/templating.png" alt="Figure 4" /></p>

<hr />

<p><h3 id="references"></a></p>

<h3>Grafana Dashboard</h3>

<ol>
<li>Satperf Dashboard template <a href="https://github.com/redhat-performance/satperf/blob/master/playbooks/monitoring/roles/dashboard-generic/templates/satellite6_general_system_performance.json.j2">can be obtained here</a></li>
<li>Variables replaced in that template <a href="https://github.com/redhat-performance/satperf/blob/master/playbooks/monitoring/roles/dashboard-generic/vars/main.yml">are in this file</a></li>
</ol>


<h3>Satperf Dashboard templating explained<h3 id="templating"></a></h3>

<p>So in the jinja template <a href="#references">[1]</a>, we have multiple &ldquo;title&rdquo;(s) under &ldquo;rows&rdquo; section and variables from <a href="#references">[2]</a> are replaced inside the template as illustrated in following piece of that jinja template:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{# Loop over per-process options here #}
</span><span class='line'>    {% for metrics in per_process_metrics %}
</span><span class='line'>      {
</span><span class='line'>        &ldquo;collapse&rdquo;: true,
</span><span class='line'>        &ldquo;editable&rdquo;: true,
</span><span class='line'>        &ldquo;height&rdquo;: &ldquo;200px&rdquo;,
</span><span class='line'>        &ldquo;panels&rdquo;: [
</span><span class='line'>
</span><span class='line'>      {% for panel in per_process_panels[item.process_list_name] %}</span></code></pre></td></tr></table></div></figure></p>

<p>Additionally, <code>"title": "CPU All"</code> in the dashboard template <a href="#references">[1]</a> refers to one row of the dashboard.</p>

<hr />

<p>Note: This post is a spin off from the main satperf project.</p>

<ul>
<li>To take a look at how <a href="https://www.github.com/redhat-performance/satperf">satperf</a> works, <a href="http://arcolife.github.io/blog/2016/08/22/satperf-a-satellite-performance-benchmarking-and-automation-tool/">refer to this post</a></li>
<li>To learn how to setup monitoring for the parameters covered in this post, <a href="http://arcolife.github.io/blog/2016/08/22/setting-up-collectd-plugins-for-red-hat-satellite-with-graphite-and-grafana/">refer to this post</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Satperf: A Satellite Performance Benchmarking and Automation Tool]]></title>
    <link href="http://arcolife.github.io/blog/2016/08/22/satperf-a-satellite-performance-benchmarking-and-automation-tool/"/>
    <updated>2016-08-22T18:18:16+05:30</updated>
    <id>http://arcolife.github.io/blog/2016/08/22/satperf-a-satellite-performance-benchmarking-and-automation-tool</id>
    <content type="html"><![CDATA[<h3>1. Intro</h3>

<p>Satperf (<a href="github.com/redhat-performance/satperf">link</a>) is a <a href="https://access.redhat.com/products/red-hat-satellite">Red Hat Satellite</a> Performance Benchmarking &amp; Automation tool that makes it super easy to quickly setup your own environment with satellite components and start running workloads. It uses ansible playbooks to manage remote execution and has built-in modules for various roles that Satellite Web UI has to offer. These are carried out with the use of hammer commands (<a href="https://access.redhat.com/documentation/en/red-hat-satellite/6.2/paged/hammer-cli-guide/chapter-1-introduction-to-hammer">read more on Hammer</a>) as an equivalent of Satellite API.</p>

<!--more-->


<p>Briefly, it does the following activities:</p>

<ul>
<li>Satellite installation and monitoring</li>
<li>uploads manifest, updates repo</li>
<li>concurrently syncs multiple Repositories from Repo Server</li>
<li>creates lifecycle environments</li>
<li>creates capsules</li>
<li>concurrently syncronizes multiple capsules</li>
<li>..etc</li>
</ul>


<p>Satperf runs modules through ansible playbooks, briefly described below under &lsquo;Ansible Playbooks in Satperf` section.</p>

<h3>2. Satperf setup</h3>

<p>This is to get the satellite installation + monitoring tools up and running.</p>

<p>Although there&rsquo;s a README included with the project, let&rsquo;s briefly go through steps needed and get an install up and running.</p>

<p>It isn&rsquo;t packaged right now, so first, clone <a href="https://www.github.com/redhat-performance/satperf">this satperf repo</a>.</p>

<h4>2.a. PREREQUISITES</h4>

<p>From project root, run: <code>$ source ./setup</code>, follow the output and act accordingly (install packages / activate virtualenv).</p>

<p>Ensure that satperf help command succeeds: <code>$ ./satperf.py -h</code></p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/source/source/images/satperf/help_menu.png" alt="Figure 1" /></p>

<h4>2.b CONFIGURATION</h4>

<p>The above step should get the setup ready for configurations. Now, configure following files in the manner illustrated:</p>

<ol>
<li>Add configurations specific to Ansible</li>
</ol>


<figure class='code'><figcaption><span>conf/ansible.cfg </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='cfg'><span class='line'><span class="na">log_path</span> <span class="o">=</span> <span class="s">~/ansible.log</span>
</span><span class='line'><span class="na">private_key_file</span> <span class="o">=</span> <span class="s">~/.ssh/id_rsa_perf</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>Add [FQDN / hostnames / IP Addresses] for your installation.
Follow the ansible inventory file pattern, as shown by sample contents of this file.</li>
</ol>


<figure class='code'><figcaption><span>conf/hosts.ini </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ini'><span class='line'><span class="k">[capsules]</span>
</span><span class='line'><span class="err">x.x.x.x</span>
</span><span class='line'><span class="k">[satellite6]</span>
</span><span class='line'><span class="err">x.x.x.x</span>
</span><span class='line'><span class="k">[graphite]</span>
</span><span class='line'><span class="err">x.x.x.x</span>
</span><span class='line'><span class="k">[grafana]</span>
</span><span class='line'><span class="err">x.x.x.x</span>
</span></code></pre></td></tr></table></div></figure>


<ol>
<li><code>conf/satperf.conf</code>: Add configurations specific to satperf.</li>
</ol>


<figure class='code'><figcaption><span>conf/satperf.conf </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='cfg'><span class='line'><span class="k">[Settings]</span>
</span><span class='line'><span class="na">hosts</span> <span class="o">=</span> <span class="s">conf/hosts.ini</span>
</span><span class='line'><span class="c1"># satperf log file</span>
</span><span class='line'><span class="na">log_file</span> <span class="o">=</span> <span class="s">log/satperf.log</span>
</span><span class='line'><span class="c1"># Logfile size in Bytes</span>
</span><span class='line'><span class="na">log_file_size</span> <span class="o">=</span> <span class="s">10000</span>
</span><span class='line'>
</span><span class='line'><span class="k">[Monitoring]</span>
</span><span class='line'><span class="c1"># for collectd multi/single-host installations one/all of satellite6:capsules</span>
</span><span class='line'><span class="c1"># hosts = satellite6</span>
</span><span class='line'><span class="na">hosts</span> <span class="o">=</span> <span class="s">satellite6:capsules</span>
</span></code></pre></td></tr></table></div></figure>


<p>   For now, leave the sections <code>[RHN], [Satellite], [Pbench]</code> untouched.
   In this post, we&rsquo;re only configuring satellite monitering module of satperf.</p>

<h4>2.c SATELLITE INSTALLATION</h4>

<p>If you already have the satellite setup running, skip below to &lsquo;MONITORING INSTALLATION&rsquo;.</p>

<p>Run <code>$ ./satperf.py -s</code></p>

<p>You&rsquo;d be asked the following, press [Enter] or type &lsquo;n&rsquo; to skip, if the component&rsquo;s already installed, or you don&rsquo;t want it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'> <span class="o">=======</span>&gt; Installing Satellite..
</span><span class='line'>Continue <span class="o">(</span>y/n<span class="o">)</span>?:
</span><span class='line'>
</span><span class='line'> <span class="o">=======</span>&gt; Installing Capsules..
</span><span class='line'>Continue <span class="o">(</span>y/n<span class="o">)</span>?:
</span></code></pre></td></tr></table></div></figure>


<p>Ignore any other components shown in menu, if so.</p>

<p>Although we&rsquo;ve tested this internally and it works, but since this is currently WIP, take a look at logs if something fails, or feel free to <a href="https://github.com/redhat-performance/satperf/issues">open an issue upstream</a>.</p>

<h4>2.c MONITORING INSTALLATION</h4>

<p>Run <code>$ ./satperf.py -m</code></p>

<p>You&rsquo;d be asked the following, press [Enter] or type &lsquo;n&rsquo; to skip, if the component&rsquo;s already installed, or you don&rsquo;t want it.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'> <span class="o">=======</span>&gt; Installing Collectd..
</span><span class='line'>Continue <span class="o">(</span>y/n<span class="o">)</span>?:
</span><span class='line'>
</span><span class='line'> <span class="o">=======</span>&gt; Installing Graphite..
</span><span class='line'>Continue <span class="o">(</span>y/n<span class="o">)</span>?:
</span><span class='line'>
</span><span class='line'> <span class="o">=======</span>&gt; Installing Grafana..
</span><span class='line'>Continue <span class="o">(</span>y/n<span class="o">)</span>?:
</span></code></pre></td></tr></table></div></figure>


<p>Although we&rsquo;ve tested this internally and it works, but since this is currently WIP, take a look at logs if something fails, or feel free to <a href="https://github.com/redhat-performance/satperf/issues">open an issue upstream</a>.</p>

<h4>2.d FINAL STEPS (WIP)</h4>

<p>Build the dashboards viewable, through Grafana, by running <code>$ ./satperf.py -i</code></p>

<p>WIP status: facing an error in this step, similar to <a href="https://github.com/bayandin/webpagetest-private/issues/1">this one</a></p>

<hr />

<h3>Ansible Playbooks in Satperf</h3>

<p>2 major categories:</p>

<ol>
<li><p>Satellite</p>

<ul>
<li>Setup (either AWS or normal environements)

<ul>
<li>Satellite</li>
<li>Capsules</li>
<li>Docker hosts (N content hosts per docker host)</li>
</ul>
</li>
<li>Satutils</li>
<li>healthcheck</li>
</ul>
</li>
<li><p>Monitoring</p>

<ul>
<li>Collectd</li>
<li>Graphite</li>
<li>Grafana</li>
</ul>
</li>
</ol>


<hr />

<h3>Playbook: Monitoring</h3>

<p>For a description of metrics we collect about Satellite installation, <a href="http://arcolife.github.io/blog/2016/08/22/setting-up-collectd-plugins-for-red-hat-satellite-with-graphite-and-grafana/">refer to this post</a></p>

<h4>Collectd: role description</h4>

<p>Installs collectd on either/all of: satellite / capsule / docker-hosts</p>

<h4>Graphite: role description</h4>

<p>Installs Graphite time-series database for metric storage of collected metrics on the configured graphite host</p>

<h4>Grafana: role description</h4>

<p>Installs Grafana time-series metric visualization framework, on the configured grafana host</p>

<hr />

<h3>Playbook: Satellite</h3>

<h4>Setup: role description</h4>

<ul>
<li>common</li>
<li>rhsm</li>
<li>setup</li>
<li>pbench_client (WIP)</li>
<li>satellite-populate</li>
</ul>


<h4>Satutils: role description (WIP)</h4>

<ul>
<li>backup</li>
<li>upload-manifest</li>
<li>restore</li>
<li>add-product</li>
<li>create-lifecycle</li>
<li>enable-content</li>
<li>content-view-create</li>
<li>content-view-publish</li>
<li>content-view-promote</li>
<li>sync-content</li>
<li>sync-capsule</li>
<li>register</li>
<li>status_check</li>
</ul>


<h4>Health check: role description (WIP)</h4>

<p>We plan to integrate <a href="https://github.com/boogiespook/sat6_healthCheck/">this github project - sat6_healthCheck</a></p>

<hr />

<h3>Blog roll: More on Satellite itself</h3>

<p>From <a href="https://access.redhat.com/announcements/2470701">Satellite&rsquo;s latest release</a>:</p>

<p>Red Hat Satellite 6.2 is now generally available, and includes the following major enhancements:</p>

<ul>
<li>Enhanced container management with RHEL Atomic</li>
<li>New remote configuration management for managed hosts</li>
<li>bootstrap.sh support for configuration management and host migration</li>
<li>The ability to change disconnected environments to connected</li>
<li>Inter-Satellite synchronization for content</li>
<li><p>PXE-less discovery for existing systems</p></li>
<li><p><a href="https://access.redhat.com/documentation/en/red-hat-satellite/6.2/single/release-notes">Release Notes</a></p></li>
<li><p><a href="https://access.redhat.com/documentation/en/red-hat-satellite/6.2/single/installation-guide#upgrading_satellite_server_and_capsule_server">Satellite Installation Guide</a></p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Setting Up Collectd Plugins With Graphite and Grafana]]></title>
    <link href="http://arcolife.github.io/blog/2016/08/22/setting-up-collectd-plugins-for-red-hat-satellite-with-graphite-and-grafana/"/>
    <updated>2016-08-22T15:48:43+05:30</updated>
    <id>http://arcolife.github.io/blog/2016/08/22/setting-up-collectd-plugins-for-red-hat-satellite-with-graphite-and-grafana</id>
    <content type="html"><![CDATA[<h3>Intro</h3>

<p>Installing collectd could be trivial, although setting up monitoring for continuous time-series metric collection should be simpler. This post is aimed at helping sysadmins setup collectd and connect it to a graphite instance, so that all those metrics could later be viewed from Grafana instance.</p>

<!--more-->


<p>Note:</p>

<p>This post is a spin off from the main satperf project. To take a look at how <a href="https://www.github.com/redhat-performance/satperf">satperf</a> works, <a href="http://arcolife.github.io/blog/2016/08/22/satperf-a-satellite-performance-benchmarking-and-automation-tool/">refer to this post</a></p>

<h3>The process</h3>

<h4>Step 1</h4>

<p>Install collectd for your system, Install Graphite server elsewhere (recommended: separate machine).</p>

<hr />

<h4>Step 2</h4>

<p>When that&rsquo;s installed, take a look at your <code>/etc/collectd.conf</code> and add plugins from the list below, as suitable</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Allow collectd to log
</span><span class='line'>LoadPlugin syslog
</span><span class='line'>
</span><span class='line'># Loaded Plugins:
</span><span class='line'>LoadPlugin write_graphite
</span><span class='line'>LoadPlugin cpu
</span><span class='line'>LoadPlugin df
</span><span class='line'>LoadPlugin disk
</span><span class='line'>LoadPlugin interface
</span><span class='line'>LoadPlugin irq
</span><span class='line'>LoadPlugin load
</span><span class='line'>LoadPlugin memory
</span><span class='line'>LoadPlugin numa
</span><span class='line'>LoadPlugin processes
</span><span class='line'>LoadPlugin postgresql
</span><span class='line'>LoadPlugin swap
</span><span class='line'>LoadPlugin turbostat
</span><span class='line'>LoadPlugin unixsock
</span><span class='line'>LoadPlugin uptime</span></code></pre></td></tr></table></div></figure>


<p>Note:</p>

<ul>
<li><p>If you&rsquo;re installing this on Red Hat Satellite, you might wanna make additional changes as per <a href="https://github.com/redhat-performance/satperf/blob/master/playbooks/monitoring/roles/collectd-generic/templates/satellite6.collectd.conf.j2">this template in satperf</a></p></li>
<li><p>For others, you might wanna take a look at the above mentioned link anyway, for it serves as a generic reference for <code>/etc/collectd.conf</code></p></li>
<li><p>Replace variable names in above referenced satperf&rsquo;s <code>collectd.conf</code> as per following defaults / or change them as suitable:</p></li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/source/source/images/collectd/table.png" alt="Figure 1" /></p>

<h5>Gotchas (for both Satellite setup as well as normal setup):</h5>

<p>1) 10 refers to 10 seconds</p>

<p>2) end results on graphite-web UI show under Metrics:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='jinja'><span class='line'><span class="cp">{{</span><span class="nv">graphite_prefix</span><span class="cp">}}</span><span class="x">.</span><span class="cp">{{</span><span class="nv">inventory_hostname</span><span class="cp">}}</span><span class="x">.&lt;metrics as per output from plugins&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>3) For candlepin password:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>grep <span class="s2">&quot;jpa.config.hibernate.connection.password&quot;</span> /etc/candlepin/candlepin.conf <span class="p">|</span> awk -F<span class="s1">&#39;=&#39;</span> <span class="s1">&#39;{print $2}&#39;</span><span class="sb">`</span>
</span></code></pre></td></tr></table></div></figure>


<p>4) For Satellite Foreman password:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>grep <span class="s2">&quot;password&quot;</span> /etc/foreman/database.yml <span class="p">|</span> awk <span class="s1">&#39;{print $2}&#39;</span> <span class="p">|</span> tr -d <span class="s1">&#39;&quot;&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<hr />

<h4>Step 3</h4>

<p>Once this is done, reload collectd server and check logs on graphite server to make sure you&rsquo;re able to receive data</p>

<h4>Other Gotchas:</h4>

<ul>
<li>Use <code>iptables -F</code> if unable to send collectd metrics</li>
<li>To graph the other parameters in Grafana, <a href="https://github.com/redhat-performance/satperf/blob/master/playbooks/monitoring/roles/dashboard-generic/templates/satellite6_general_system_performance.json.j2">this satellite generic dashboard file</a>

<ul>
<li>To simply look at which metrics are touched in above dashboard template, refer to <a href="https://github.com/redhat-performance/satperf/blob/master/playbooks/monitoring/roles/dashboard-generic/vars/main.yml">this satperf vars file</a></li>
</ul>
</li>
<li>FYI, I&rsquo;ve got an <a href="https://github.com/sosreport/sos/pull/866">open PR to add collectd info to sos report, as a plugin</a></li>
<li>I&rsquo;ll add some screenshots to this post ASAP.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Setting Up Your Own Blog Hosted on Github]]></title>
    <link href="http://arcolife.github.io/blog/2016/06/12/setting-up-your-own-blog-on-github/"/>
    <updated>2016-06-12T04:37:14+05:30</updated>
    <id>http://arcolife.github.io/blog/2016/06/12/setting-up-your-own-blog-on-github</id>
    <content type="html"><![CDATA[<p>I recently shifted from having a static page as my <a href="http://arcolife.github.io/blog/2016/06/06/first-post/">github.io link</a> to making a blog out of the default .io page for my Github account. I found it pretty cool to be able to push stuff through markdown (although even that formatting is configurable under <code>Rakefile</code> of octopress source code).</p>

<p>So here&rsquo;s a really short post on how to set it up.</p>

<!--more-->


<h3>Step 0: Make sure you have a github account and a suitable repo</h3>

<p>Make an account on <a href="https://www.github.com/">this github website</a></p>

<p>..and then, make a new repository on github, called <code>&lt;username&gt;.github.io</code></p>

<p>Reference: I have a repo called: <code>http://github.com/arcolife/arcolife.github.io</code></p>

<h3>Step 1: Get your gear!</h3>

<p>Make sure you have git and ruby installed in your command line environment.</p>

<p>I had the following versions:</p>

<ul>
<li><p>ruby 2.2.5p319 (2016-04-26 revision 54774) [x86_64-linux]</p>

<p>Although lower versions (such as 1.9) might work too.</p></li>
<li><p>git version 2.5.5</p></li>
</ul>


<h3>Step 2: Get octopress</h3>

<ul>
<li>Download the repository under a suitable location on your disk:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git clone git://github.com/imathis/octopress.git octopress
</span><span class='line'>cd octopress/</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Next, if you run <code>bundle install &amp;&amp; rake install</code>, then IIRC, you&rsquo;d get a failure.
If not, then the almighty Gods are with you on this lad ..else,
make a change to <code>group:development</code> in <code>Gemfile</code> by adding the following:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  gem 'json_pure', '~&gt; 1.8.3'</span></code></pre></td></tr></table></div></figure>


<p>  This is because when I tried to install the requirements,
  I got an error and a recommendation to add the above.
  Refer to <a href="https://github.com/arcolife/arcolife.github.io/blob/source/Gemfile#L16">this file under my repo</a>,
  if in doubt.</p>

<p>  Be advised that this micro-step may not be necessary in future releases or in your environment.</p>

<ul>
<li>Now install requirements along with octopress itself:
<code>
bundle install &amp;&amp; rake install
</code></li>
</ul>


<h3>Step 3: Connect your username.github.io with octopress</h3>

<p>Run this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake setup_github_pages</span></code></pre></td></tr></table></div></figure>


<p>Follow the instructions and supply input as asked.</p>

<p>This would clone and download your repo to a folder called <code>source</code> and change your
branch from <code>master</code> to <code>source</code>. You should check this with <code>git remove -v</code>.
I got something like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>octopress    git://github.com/imathis/octopress.git (fetch)
</span><span class='line'>octopress git://github.com/imathis/octopress.git (push)
</span><span class='line'>origin        https://github.com/arcolife/arcolife.github.io (fetch)
</span><span class='line'>origin        https://github.com/arcolife/arcolife.github.io (push)</span></code></pre></td></tr></table></div></figure>


<p>and on running <code>git branch</code> it should display <code>* source</code>.</p>

<p>If you then do a <code>git status</code> you&rsquo;d get something like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>your branch is based on 'origin/master', but the upstream is gone.
</span><span class='line'>(use "git branch --unset-upstream" to fixup)</span></code></pre></td></tr></table></div></figure>


<p>..which is fine. Let&rsquo;s move on to next step.</p>

<hr />

<p>Side note:
However, if in case, this fails to change your branch to <code>source</code>,
i.e, you don&rsquo;t have your username under urls of <code>origin</code> in your output of
<code>git remote -v</code> ..then you&rsquo;d have to do this step manually like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>git remote add origin git@github.com:arcolife/arcolife.github.com.git
</span><span class='line'>git branch -m master source
</span><span class='line'>git branch</span></code></pre></td></tr></table></div></figure>


<p>This should now display <code>* source</code>.</p>

<h3>Step 4: Try running in preview mode</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake preview</span></code></pre></td></tr></table></div></figure>


<p>This should start a server on <code>http://localhost:4000</code> and you should be able to
view a default colorful octopress page.</p>

<h3>Step 5 (optional): Deciding where to keep the default blog</h3>

<p><a href="http://octopress.org/docs/deploying/subdir/">Check this out</a></p>

<p>Mine is with default settings so I haven&rsquo;t tried this out.</p>

<h3>Step 6: Push your changes to github and deploy the blog</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake generate
</span><span class='line'>
</span><span class='line'>git add .
</span><span class='line'>git commit -am "init github based octopress"
</span><span class='line'>git push origin source
</span><span class='line'>
</span><span class='line'>rake deploy</span></code></pre></td></tr></table></div></figure>


<p>This might take upto 5 mins sometimes or may be a matter of
few seconds depending on how the update job runs and the load
on github servers. Refresh and check in intervals.</p>

<h3>Step 7: A new post</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rake new_post["My first post"]</span></code></pre></td></tr></table></div></figure>


<p>This would generate a new post and display a message like this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mkdir -p source/_posts
</span><span class='line'>Creating new post: source/_posts/2016-06-12-my-first-post.markdown</span></code></pre></td></tr></table></div></figure>


<p>Edit that file and write up a post using markdown format.
Repeast steps in <code>Step 6</code> to deploy.</p>

<h3>Step 8: Tweaks quickstart</h3>

<p>Some of these tips are well covered under <a href="http://octopress.org/docs/blogging/">Octopress' blogging basics</a>
and under <a href="https://github.com/octopress/octopress#configuration">octopress' github README config section</a>
but just pointing them out for quickstart references:</p>

<h4>Configure blog name and other basics</h4>

<p>Open <code>_config.yml</code> and edit the following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>title:
</span><span class='line'>subtitle:
</span><span class='line'>author:</span></code></pre></td></tr></table></div></figure>


<p>repeat steps from <code>Step 6</code> to see changes live on your username.github.io</p>

<h4>Linking your octopress blog with social networks</h4>

<p>Edit <code>_config.yml</code> and edit the following (change your usernames accordingly):</p>

<ul>
<li>Github:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>github_user: arcolife
</span><span class='line'>github_repo_count: 5</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Google Plus:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>googleplus_user: +ArchitSharma1337</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Twitter: (read more below under <code>Adding asides</code> section on adding twitter feed)</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>twitter_user: arcolife
</span><span class='line'>+twitter_show_replies: false
</span><span class='line'>+twitter_follow_button: true
</span><span class='line'>+twitter_show_follower_count: false</span></code></pre></td></tr></table></div></figure>


<ul>
<li>For facebook like on posts:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>facebook_like: true</span></code></pre></td></tr></table></div></figure>


<h4>Images in post</h4>

<p>If you wanna insert images, add them under <code>source/images</code> and you could either:</p>

<ul>
<li><p>Refer to their path either like this:</p>

<pre><code>![Sample image caption](https://raw.githubusercontent.com/username/username.github.io/master/images/sample.png)
</code></pre>

<p>Replace username with your github username, and <code>images/sample.png</code> with whatever path your images are in,
under <code>source/</code></p></li>
<li><p>Or give a relative path like this:</p>

<pre><code>![Image caption](../images/sample.png)
</code></pre></li>
</ul>


<p>The second option is hackish &amp; works based on your directory structure.
<a href="http://stackoverflow.com/a/17089293/1332401">There are other ways of doing this as well</a></p>

<h4>Adding <code>asides</code> (panel contents)</h4>

<p>Edit <code>_config.yml</code> as follows:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>blog_index_asides:  [custom/asides/about.html, asides/recent_posts.html, asides/github.html, asides/googleplus.html]
</span><span class='line'>post_asides:        [custom/asides/about.html, asides/recent_posts.html, asides/github.html,  asides/googleplus.html]</span></code></pre></td></tr></table></div></figure>


<p>You could add your custom asides / make changes to layout from files under <code>source/_includes</code> folder.
For example, to add your twitter feed, you&rsquo;d wanna take a look <a href="http://blog.jmac.org/2013-03-30-putting-twitter-back-into-octopress.html">at this blog post</a> which tells you how to add that and why it was removed as a default.</p>

<h4>Google analytics</h4>

<p>This is to track location/count of visitors to your website. Open <code>_config.yml</code> and edit the following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>google_analytics_tracking_id: &lt;add your ID here&gt;</span></code></pre></td></tr></table></div></figure>


<p>You&rsquo;d need to have an account on <a href="https://analytics.google.com/">this google analytics website</a>
to get an ID. There&rsquo;s a limit on number of free IDs allotted to your google account. Check out
the T&amp;Cs on their website.</p>

<h4>Comments in blog posts</h4>

<p>If you wanna enable <code>Disqus</code> based comments, you need to have an account on <a href="https://www.disqus.com/admin/">this disqus admin website</a> and add the url <code>&lt;username&gt;.github.io</code> under trusted domains on <code>https://&lt;disqus admin username&gt;.disqus.com/admin/settings/advanced/</code> and you need to configure your <code>community</code> name (which is nothing but a setting for your site) under <code>https://&lt;disqus admin username&gt;.disqus.com/admin/settings/general/</code></p>

<h4>Adding a static website under your github website</h4>

<p>If you&rsquo;d like to link up a static content (fully supporting it&rsquo;s own html/css layout),
just add them under <code>source/&lt;new_dir&gt;/</code> and you should be able to access that
under <code>username.github.io/&lt;new_dir&gt;</code></p>

<p>Then, go ahead and edit <code>_config.yml</code> and edit the following:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>disqus_short_name: arcolife
</span><span class='line'>disqus_show_comment_count: true</span></code></pre></td></tr></table></div></figure>


<h4>Working on drafts, disabling comments and adding categories</h4>

<p>When you&rsquo;re writing a blog post, change true/false or add categories
to your _posts/<post>.md as shown below:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>comments: true
</span><span class='line'>published: true
</span><span class='line'>categories: [RHEL, Linux, Microservices]</span></code></pre></td></tr></table></div></figure>


<p>A push to github with <code>published: false</code> means the markdown has been safely
committed to source branch on your repo, but the post is not publicly visible.
This way you could keep working on the file and change to true when it&rsquo;s ready.</p>

<hr />

<p>All that said, I still haven&rsquo;t added an &lsquo;about&rsquo; section to my post,
or moved it under a custom <code>blog/</code> folder successfully. Or changed the
default page to something else or made changes to default theme.
If you&rsquo;ve done that, please add a comment here on how you did it
or a link to it if you&rsquo;ve blogged about it. Would save me some time eh! :)</p>

<p>Thats it for now folks!</p>

<p>Share it across, post a comment if you&rsquo;d like to add something
to this post, or want any edits made or found a flaw in the flow
or would simply like to let me know if this helped.</p>

<p>Cheers!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sarjitsu: A Project on Visualizing System's Activity]]></title>
    <link href="http://arcolife.github.io/blog/2016/06/06/sarjitsu-a-project-on-visualizing-your-systems-activity/"/>
    <updated>2016-06-06T05:50:34+05:30</updated>
    <id>http://arcolife.github.io/blog/2016/06/06/sarjitsu-a-project-on-visualizing-your-systems-activity</id>
    <content type="html"><![CDATA[<h3>1. What is it about?</h3>

<p><strong>Sarjitsu</strong>, or, SAR Jitsu, is a one stop shop for people who&rsquo;re looking to visualize their system data, based on <a href="http://sebastien.godard.pagesperso-orange.fr/matrix.html">System Activity Report (SAR) data generated by Sysstat</a>. Screenshots from the app are near the end of this post.</p>

<!--more-->


<h4>1.a. How do I get cracking on the source?</h4>

<p>It has been <a href="http://github.com/distributed-system-analysis/sarjitsu">open sourced under Distributed System Analysis</a> efforts. Take a look!</p>

<h3>2. What does it offer?</h3>

<p>It includes throwing <a href="http://sebastien.godard.pagesperso-orange.fr/man_sadc.html">SA binary</a> files at an instance of sarjitsu&rsquo;s web app and extracting the following valuable information out of it:</p>

<ul>
<li>Nodename of the machine whose data is contained within the binary</li>
<li>Time range of the data collected</li>
<li>Extraction of the time series data and visualization in a feature rich dashboard using <a href="http://grafana.org/features/">Grafana</a></li>
<li>Graphing of the following parameters:</li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/options.png" alt="Figure 1" /></p>

<h3>3. How is it different from live monitoring ?</h3>

<p>Sometimes issues can&rsquo;t just be detected out of live monitoring and we might need to use historical data. For live monitoring, already tools like <a href="https://collectd.org/">collectd</a> exist. If you&rsquo;ve got your data stored in form of SA binary file, Sarjitsu can visualize it.</p>

<p>Sarjitsu would enable you to:</p>

<ul>
<li><p>Debug issues with your machine by presenting time series data collected on a minute&rsquo;s granularity level. This is entirely configurable through the  <a href="http://sebastien.godard.pagesperso-orange.fr/matrix.html">SAR setup</a> that your system has.</p></li>
<li><p>Figure out where the bottleneck lies by presenting all the information under a common y-axis and correlate results</p></li>
<li><p>Visualize pbench results (additional feature). It comes with a command line tool which you could point to results dir of a <a href="http://github.com/distributed-system-analysis/pbench/">pbench run</a> and it will find all the <code>sar.data</code> files and visualize them.</p></li>
</ul>


<h3>4. Ok. Tell me more about..</h3>

<p>It is built in a manner so that it could scale up real fast, because of it&rsquo;s ease of use and also because it is based on Docker containers, around which a whole ecosystem exists on scaling up. If you&rsquo;re willing to use this in production, send us a holler and we&rsquo;ll get back to you.  (Refer to the section at the end.)</p>

<h4>4.a. Software Stack</h4>

<ol>
<li>Docker containers</li>
<li>Python-Flask + uWSGI</li>
<li>Nginx</li>
<li>PostgreSQL</li>
<li>Redis</li>
<li>ElasticSearch</li>
<li>Grafana</li>
<li>Twitter Bootstrap</li>
</ol>


<h4>4.b. Architecture</h4>

<p>The project is divided into 5 components:</p>

<ul>
<li>Grafana for visualizations</li>
<li>Postgres (used for storing Grafana&rsquo;s dashboards)</li>
<li>Elasticsearch (used as a data source)</li>
<li>API Engine in Python-Flask</li>
<li>Web Server in Python-Flask (previously written in NodeJS)</li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/sarjitsu_architecture.png" alt="Figure 2" /></p>

<h3>5. Project Status</h3>

<p>The project development status is still in alpha mode, since there have been
a lot of drastic changes over the past year. In fact, I&rsquo;m still waiting for a few to be included in core of grafana&rsquo;s code
(<a href="https://github.com/grafana/grafana/pull/4694">PR #4694</a> that I&rsquo;ve submitted). In fact, earlier last year, I had released an <a href="http://github.com/distributed-system-analysis/es-graphite-shim">elasticsearch-graphite shim of sorts</a>, that made it possible for data to be sourced from ES into Grafana. Later on though, the native support was included and I had to move on. (Yeah it was difficult to let go of the python-django project!).</p>

<p>The usage of nested documents within grafana, sourced from elasticsearch, depends on presence of this feature (PR #4694). Of course though, if someone is willing to make a <a href="https://copr.fedorainfracloud.org/">Fedora Copr</a> based custom packaging out of this
project, I&rsquo;d be really really glad and might even invite you to my annual Great Gatsby themed party.</p>

<p>Once again, checkout the project at <a href="http://github.com/distributed-system-analysis/sarjitsu">DSA</a> and please contribute! :)</p>

<h4>5.a. Upcoming features</h4>

<ul>
<li>Statistics about top N devices. Example: CPUs, Disks or Network devices.</li>
<li>Options to integrate this with hybrid cloud ecosystem.</li>
<li><p>Service Discovery for individual components.</p></li>
<li><p>Of course it&rsquo;s only as good as you make it.</p></li>
</ul>


<p>So more on this later. Feel free to open a feature request on github and maybe even send a PR!</p>

<h3>6. Contributions</h3>

<p>I&rsquo;ve opened a list of issues and labelled them accordingly on <a href="https://github.com/distributed-system-analysis/sarjitsu/issues">this Github issues list for Sarjitsu</a>. Feel free to start a discussion under a github issue&rsquo;s comments section, or submit a Pull Request for it. Cheers and happy debugging!</p>

<p>We hangout on #pbench under FreeNode on IRC. Feel free to ping me there or tweet about it (I&rsquo;m @arcolife).</p>

<h3>7. Screenshots from app</h3>

<ul>
<li>Landing Page</li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/landing.png" alt="Figure 3" /></p>

<ul>
<li>Results Page</li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/results.png" alt="Figure 4" /></p>

<ul>
<li>Commandline uploader sample</li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/vizit.png" alt="Cmdline based uploader - vizit" /></p>

<ul>
<li>Grafana Dashboard</li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/dashboard.png" alt="Figure 5" /></p>

<ul>
<li>Grafana Visualization example</li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/viz1.png" alt="Viz 1" /></p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/viz2.png" alt="Viz 2" /></p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/viz3.png" alt="Viz 3" /></p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/viz4.png" alt="Viz 4" /></p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/viz5.png" alt="Viz 5" /></p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/viz6.png" alt="Viz 6" /></p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/viz7.png" alt="Viz 7" /></p>

<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/viz8.png" alt="Viz 8" /></p>

<ul>
<li>This one is a demo of the upcoming nested docs feature..
refer to Grafana&rsquo;s <a href="https://github.com/grafana/grafana/pull/4694">PR #4694</a> for more:</li>
</ul>


<p><img src="https://raw.githubusercontent.com/arcolife/arcolife.github.io/master/images/sarjitsu/viz9.png" alt="Viz 9" /></p>

<h4>8. Last but not the least</h4>

<p>If you think there is a significant improvement possible to the architecture of this project, or a potential collaboration opportunity with one of your own projects, contact us right now and we could take this further. Refer to <a href="http://work.arcolife.in/intro">this page</a> on more info about contacting me or say hello on #pbench under <a href="https://freenode.net/">FreeNode</a> on IRC.</p>

<p>With Love,</p>

<p>- <a href="http://github.com/distributed-system-analysis/">Team DSA</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[First Post]]></title>
    <link href="http://arcolife.github.io/blog/2016/06/06/first-post/"/>
    <updated>2016-06-06T04:27:15+05:30</updated>
    <id>http://arcolife.github.io/blog/2016/06/06/first-post</id>
    <content type="html"><![CDATA[<h1>A test post</h1>

<p>My intro page has now been moved to <a href="http://arcolife.github.io/intro">/intro</a></p>

<p>I&rsquo;ve noted down a list of posts I&rsquo;ve been waiting to blog about, for a long time now.. Finally I&rsquo;ve got something better than free version of wordpress to try this out. My older blog was <a href="http://blog.arcolife.in/">Arcolife&rsquo;s Digital Sweat</a> and is still active. This one&rsquo;s a pure work related blog, or atleast, I plan to keep it so, for now.</p>
]]></content>
  </entry>
  
</feed>
